{% extends 'base.html.twig' %}

{% block title %}
	{{parent()}}
	-
	{{ season.program.title }}
	- Saison
	{{season.number}}
{% endblock %}

{% block body %}
	<div class="col-9 mt-3 m-auto">
		<div class="d-flex flex-column">
			<h2 class="bolder">{{ season.program.title }}
				- Saison
				{{season.number}}
				({{season.year}})</h2>
			<h3 class="bolder mt-4">Ã‰pisode
				{{episode.number}}
				-
				{{episode.title|capitalize}}</h3>
			<p>{{episode.synopsis}}</p>
		</div>

		<div>
			{% if form is defined %}

				<p class='bolder'>Donne ton avis !</p>
				<div>
					{{ form_start(form) }}
					{{ form_widget(form.rate) }}
					{{ form_widget(form.comment) }}

					<button class="my-3" type="submit">Envoyer</button>
					{{ form_end(form) }}
				</div>
			{% else %}
				<p class="bolder">Connecte-toi pour donner ton avis !</p>
			{% endif %}
			<p class="underlined">{{episode.comments|length}}
				commentaires
			</p>
			<div>
				{% for comment in episode.comments %}
					<div class="card w-100 my-1">
						<div class="card-body w-100">
							<div class="d-flex flex-row justify-content-between">
								<p class="bolder mb-0">{{comment.author.username}}</p>
								{% if is_granted("ROLE_ADMIN") or is_granted("ROLE_CONTRIBUTOR") and comment.author.id == app.user.id %}
									{{ include('comment/_delete_form.html.twig') }}
								{% endif %}
							</div>
							<p>{{comment.rate}}/5</p>
							<p class="mb-0">{{comment.comment}}</p>
						</div>
					</div>
				{% endfor %}
			</div>

		</div>
		<div>
			<img id="category" src="{{ asset('build/images/episode.png') }}" height:'200'>
		</div>
	</div>
	<div class="mb-2 fixed-bottom">
		<a href="{{ path('program_season_show', {programSlug: season.program.slug, seasonId: season.id }) }}">
			<img src="{{ asset('build/images/previous.png') }}" id="returnLogo">
			Retour
		</a>
	</div>
{% endblock %}
